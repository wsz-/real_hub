# -*- coding: cp936 -*-
import threading
import re
from subprocess import check_output
o=check_output('ping 192.168.2.240')
r=re.compile('TTL')
di=[]
c=0
class pingC(threading.Thread):
    def __init__(self,ip):
        threading.Thread.__init__(self)
        self.ip=ip
    def run(self):
        try:
            o=check_output(' '.join(['ping','-n','1',self.ip]))
            # print threading.activeCount()
            if re.findall('TTL',o):
                # print self.ip,'\n'
                di.append(self.ip)
        except:
            pass
for i in range(1,255):
    t=pingC('192.168.2.'+str(i))
    t.start()
while threading.activeCount() >= 2:
    pass
print '有',len(di),'个主机在线。'
print '\n'.join(di)
